考点    

综合

热点指数    35370
通过率    26.54%
题目    

把字符串转换成整数


具体题目    将一个字符串转换成一个整数(实现Integer.valueOf(string)的功能，但是string不符合数字要求时返回0)，要求不能使用字符串转换整数的库函数。         数值为0或者字符串不是一个合法的数值则返回0。输入描述:输入一个字符串,包括数字字母符号,可以为空输出描述:如果是合法的数值表达则返回该数字，否则返回0示例1输入复制+2147483647    1a33输出复制2147483647    0
讨论    82
马客(Mark)
  简单常用函数 
class Solution {
public:
    int StrToInt(string str) {
        int n = str.size(), s = 1;
        long long res = 0;
        if(!n) return 0;
        if(str[0] == '-') s = -1;
        for(int i = (str[0] ==  '-' || str[0] == '+') ? 1 : 0; i < n; ++i){
            if(!('0' <= str[i] && str[i] <= '9')) return 0;
            res = (res << 1) + (res << 3) + (str[i] & 0xf);//res=res*10+str[i]-'0';
        }  
        return res * s;
    }
};
34
Java
JacobGo！
public class Solution {
    public static boolean flag;
    public static int StrToInt(String str) {
        flag = false;
        //判断输入是否合法
        if (str == null || str.trim().equals("")) {
            flag = true;
            return 0;
        }
        // symbol=0,说明该数为正数;symbol=1，该数为负数;start用来区分第一位是否为符号位
        int symbol = 0;
        int start = 0;
        char[] chars = str.trim().toCharArray();
        if (chars[0] == '+') {
            start = 1;
        } else if (chars[0] == '-') {
            start = 1;
            symbol = 1;
        }
        int result = 0;
        for (int i = start; i < chars.length; i++) {
            if (chars[i] > '9' || chars[i] < '0') {
                flag = true;
                return 0;
            }
            int sum= result * 10 + (int) (chars[i] - '0');
            
            
            if((sum-(int) (chars[i] - '0'))/10!=result){
            	flag=true;
            	return 0;
            }
            
            result=result * 10 + (int) (chars[i] - '0');
            /*
             * 本人认为java热门第一判断是否溢出是错误的，举个反例
             * 当输入为value=2147483648时，在计算机内部的表示应该是-2147483648
             * 显然value>Integer.MAX_VALUE是不成立的
            */
        }
        // 注意：java中-1的n次方不能用：(-1)^n .'^'异或运算
        // 注意，当value=-2147483648时，value=-value
        result = (int) Math.pow(-1, symbol) * result;
        return result;
    }
} 
28
C/C++
kakaan
  边界条件： 
  数据上下
溢出
空字符串
只有正负号
有无正负号
错误标志输出
class Solution {
public:
    enum Status{kValid = 0,kInvalid};
    int g_nStatus = kValid;
    
    int StrToInt(string str) {
    	g_nStatus = kInvalid;
        long long num = 0;
        const char* cstr = str.c_str();
        if( (cstr != NULL) && (*cstr != '\0') )
        {
            int minus = 1;
            if(*cstr == '-')
            {
                minus = -1;
                cstr++;
            }
            else if(*cstr == '+')
                cstr++;
            
            while(*cstr != '\0')
            {
                if(*cstr > '0' && *cstr < '9')
                {
                    g_nStatus = kValid;
                    num = num*10 + (*cstr -'0');
                    cstr++;
                    if( ((minus>0) && (num > 0x7FFFFFFF)) ||
                        ((minus<0) && (num > 0x80000000)) )
                    {
                        g_nStatus = kInvalid;
                        num = 0;
                        break;
                    }
                }
                else
                {
                    g_nStatus = kInvalid;
                    num = 0;
                    break;
                }
            }
            
            if(g_nStatus == kValid)
                num = num * minus;
            
        }
        return (int)num;
    }
};
10
Python
离疏
# -*- coding:utf-8 -*-
class Solution:
    def StrToInt(self, s):
        # write code here
        numlist=['0','1','2','3','4','5','6','7','8','9','+','-']
        sum=0
        label=1#正负数标记
        if s=='':
            return 0
        for string in s:
            if string in numlist:#如果是合法字符
                if string=='+':
                    label=1
                    continue
                if string=='-':
                    label=-1
                    continue
                else:
                    sum=sum*10+numlist.index(string)
            if string not in numlist:#非合法字符
                sum=0
                break#跳出循环
        return sum*label
 
20
C/C++
noobfox
class Solution {
public:
    int StrToInt(string str) {
        if(str.empty())
            return 0;
        int symbol = 1;
        if(str[0] == '-'){//处理负号
            symbol = -1;
        	str[0] = '0'; //这里是‘0’ 不是0
        }else if(str[0] == '+'){//处理正号
            symbol = 1;
            str[0] = '0';
        }
        int sum = 0;
        for(int i=0;i<str.size();++i){
            if(str[i] < '0' || str[i] > '9'){
                sum = 0;
            	break;
            }
             
            sum = sum *10 + str[i] - '0';
            
        }
        return symbol * sum;
        
    }
};
36
&rdquo;巴黎风
public int StrToInt(String str)
	{
		if (str.equals("") || str.length() == 0)
			return 0;
		char[] a = str.toCharArray();
		int fuhao = 0;
		if (a[0] == '-')
			fuhao = 1;
		int sum = 0;
		for (int i = fuhao; i < a.length; i++)
		{
			if (a[i] == '+')
				continue;
			if (a[i] < 48 || a[i] > 57)
				return 0;
			sum = sum * 10 + a[i] - 48;
		}
		return fuhao == 0 ? sum : sum * -1;
	}
85
ABCD
你倒是给个规则啊，要不鬼知道怎么样转换？全部转为1可好？
7
shijiacheng
/**
 * 把字符串转成整数
 * 题目描述
 * 将一个字符串转换成一个整数，要求不能使用字符串转换整数的库函数。
 * 数值为0或者字符串不是一个合法的数值则返回0
 * 输入描述:
 * 输入一个字符串,包括数字字母符号,可以为空
 * 输出描述:
 * 如果是合法的数值表达则返回该数字，否则返回0
 * 示例1
 * 输入
 * +2147483647
 * 1a33
 * 输出
 * 2147483647
 * 0
 *
 * @author shijiacheng
 * @date 2018/2/17
 */
public class StringToIntSolution {
    public int StrToInt(String str) {
        if (str.length()==0){
            return 0;
        }else if (str.length() == 1&&(str.charAt(0)=='-' ||str.charAt(0)=='+' )){
            return 0;
        }else {
            int flag = 0;//1是整数，2是负数
            boolean error = false;
            char[] chars = str.toCharArray();
            int i = 0;
            if (chars[0]=='-'){
                i++;
                flag= 2;
            }else if (chars[0]=='+'){
                i++;
                flag= 1;
            }
            int result = 0;
            for (int j = i; j < chars.length; j++) {
                if (chars[j]>='0'&&chars[j]<='9'){
                    result = result*10+(chars[j]-'0');
                }else {
                    error = true;
                    break;
                }
            }
            if (!error){
                if (flag==2){
                    result = result*(-1);
                }
                return result;
            }else {
                return 0;
            }
        }
    }
}
6
妇科圣手
public class Solution {
    public int StrToInt(String str) {
        int res = 0;
        
        int symbol = 1;
        boolean isInvalid = false;   // 区分非法输入和0
        char[] arr = str.toCharArray();
        int n = arr.length;
        
        if (n <=  0 || str == null) {
            isInvalid = true;
            return 0;
        }
        
        if (arr[0] == '-')
            symbol = -1;
        
        for (int i = (arr[0] ==  '-' || arr[0] == '+') ? 1 : 0; i < n; ++i) {
            if (!('0' <= arr[i] && arr[i] <= '9')) {
               	isInvalid = true;
                return 0;
            }
            res = (res << 1) + (res << 3) + (arr[i] & 0xf); //res=res*10+arr[i]-'0'
            
            // 溢出判断
            if((symbol == 1 && res>Integer.MAX_VALUE) || (symbol == -1 && res < Integer.MIN_VALUE)) {
                isInvalid = true;
            	return 0;
            }
        }
        
        return res * symbol;
    }
}
要点： 1. 异常输入和0输入的区分，设置一个全局变量
           2. 正负号的处理
           3. 溢出处理
5
虵乡遇故知
public class Solution {
    public int StrToInt(String str) {
        boolean isPosotive = true;
        char[] arr = str.toCharArray();
        int sum = 0;
        for(int i = 0; i < arr.length; i++) {
            if (arr[i] == '+') {
                continue;
            }
            else if (arr[i] == '-') {
                isPosotive = false;
                continue;
            }
            else if (arr[i] < '0' || arr[i] > '9') {
                return 0;
            }
            sum = sum * 10 + (int)(arr[i] - '0');
        }
        if (sum == 0) {
            return 0;
        }
        return isPosotive == true ? sum : -sum;
    }
}
 
4
LinuX18
class Solution {
public:
    int StrToInt(string str) 
    {
        int m=str.length();
        if(m==0) return 0;
        int result=0,flag=1;
        int index=str.find_first_not_of(' ');
        if(str[index]=='+' || str[index]=='-')
            flag = str[index++]=='-'? -1 : 1;
        for(;index<m;index++)
        {
            if(str[index]>='0' && str[index]<='9')
            {
                result = result*10+(str[index]-'0');
                if(result*flag > INT_MAX)
                    return INT_MAX;
                if(result*flag < INT_MIN)
                    return INT_MIN;
            }
            else
             {
                result = 0;
                break;
            }
        }
        return result*flag;
    }
}; 
3
coder_hyman
public class Solution {
    public int StrToInt(String str) {
        if (str == null || "".equals(str)) return 0;
		int len = str.length();
		if (len == 1 && !isNumChar(str.charAt(0))) return 0;
		//保存数值对应的字符
		char[] numChars = new char[len];
		int res = 0;
		int index = 0;
		char sign = '+';//保存符号
		boolean isValid = true;
		for (int i = 0; i < len; i++) {
			char c = str.charAt(i);
			if (i == 0 && (c == '-' || c == '+')) {
				sign = c;
				continue;
			}
			if (isNumChar(c)) {
				numChars[index++] = c;
			} else {
				isValid = false;
				break;
			}
		}
		if (!isValid) {
			return 0;
		}
		for (int i = 0; i < index; i++) {
			res += (numChars[i] - '0') * pow(10, index - i - 1);
		}
		return sign == '-' ? 0 - res : res;
    }
    
    /**
	 * 判断一个字符是否是数字
	 * @param c
	 * @return
	 */
	private boolean isNumChar(char c) {
		return c >= '0' && c <= '9';
	}
	
	private int pow(int base, int exp) {
		return (int) Math.pow(base, exp);
	}
}
3
忆水寒
class Solution {
public:
    int StrToInt(string str) {
        if(str.length()<=0) return 0;
        int i;
        for(i=0;i<str.length();i++)
        {
            if(str[i]!=' ') break;
        }
        int flag=true;
        if(str[i]=='+') 
        {
            flag=true;
            i++;
        }
        if(str[i]=='-')
        {
            flag=false;
            i++;
        }
        int temp=0,digit=0;
        for(int j=i;j<str.length();j++)
        {
            if(str[j]<'0'||str[j]>'9')
                return 0;
            else if(str[j]>='0'&&str[j]<='9')
            {
                digit=str[j]-'0';
                if((flag==true&&temp>0x7fffffff)||(flag==false&&temp<(unsigned int)0x80000000))
                    return 0;
               temp=temp*10+ digit;   
            }
        }
        return (flag==true)?temp:-temp;
    }
};
5
Java
航天之星
public class Solution {
    
    //1.字符串为空
    //2.只有一个正或负号
    //3.整数上下溢出 Integer.MAX_VALUE (2^31-1)  Integer.MIN_VALUE(-2^31)
    public int StrToInt(String str) {
        
        if(str == null ||str.length()==0){
            return 0;
        }
		char[] c=str.toCharArray();
        boolean minus = false;
        int num = 0;
        int i=0;
        //数组溢出：下标大于数组长度！比如c.length ==1,当有c[1]出现时则数组溢出
        if(c[i]=='+'){
            ++i;
            
        }else if(c[i]=='-'){
            
            ++i;
            minus=true;
        }
        if(i<c.length){
            num = StrToIntCore(c,minus,i);
        }else{
            return num;
        }   
        return num;
        
    }
    
    
    int StrToIntCore(char[] str,boolean minus,int i){
        int num = 0;
      
        
        for(int j = i;j<str.length;j++){
            
            if(str[j]>='0'&&str[j]<='9'){
                
                int flag = minus ? -1:1;
                //str[j]-'0' 是为了把字符转为int数字
                num = num*10 + flag*(str[j] - '0');
                //
                if((!minus&&num>Integer.MAX_VALUE)||(minus&&num<Integer.MIN_VALUE)){
                    num=0;
                    break;
                }
                
            }else{
                num = 0;
                break;
            }
        }
        return num;
        
    }
    
    
}
12
Python
华科平凡
python solution # -*- coding:utf-8 -*-
class Solution:
    def StrToInt(self, s):
        # write code here
        try:
            return int(s)
        except:
            return 0
2
Java
木子木泗
public class Solution {
    public int StrToInt(String str) {
        int res = 0;
        //合法检测
        if (!str.matches("\\+{0,1}\\-{0,1}[0-9]{1,}"))
            return res;
        int len = str.length();
        for (int i = len - 1; i >= (str.charAt(0) == '-' || str.charAt(0) == '+' ? 1 : 0); i--) {
            res += (int) Math.pow(10, (len - 1 - i)) * (str.charAt(i) - '0');
        }
        return str.charAt(0) == '-' ? -res : res;
    }
}
 
2
drdr
//测试样例不全，leetcode上做了很久都不对。
//这里都不知道怎么写的居然对了。。。
class Solution {
public:
    int StrToInt(string str) {
        long long ret = 0;
        int sz = str.size();
        bool flag = false;
        for(int i = 0; i < sz ; ++i){
            if(str[i]>='0' && str[i]<='9'){
                ret = ret*10 + (str[i] - '0');                
            }
            else if(str[i]=='-' && i==0){
                flag = true;
            }
            else if((str[i]<'0' || str[i]>'9') && i!=0)
                return 0;
        }
        if(flag) ret = -ret;
        return ret;
    }
};
2
牛客942775号
  其实非常简单,代码如下: 
public int StrToInt(String str){
  if(null==str||str.length()<1){
    return 0;
  }
  boolean negativeFlag=false;
  char[]charArray=str.toCharArray();
  if（charArray[0]=='-'){
    negativeFlag=true;
  }
  int sum=0;
  for(int i=0;i<charArray.length;++i){
    if(i==0&&charArray[i]=='+'||charArray[i]=='-'){
      continue;
    }
    if(charArray[i]<'0'||charArray[i]>'9'){
      return 0;
    }
    sum=sum*10+(charArray[i]-'0');
}
 return negativeFlag?(0-sum):sum;
}
2
WillWu
/*
1、首先有可能有正负号，也有可能没有
2、当输入字符串中有非数字的时候输出为0；
*/
int StrToInt(string str)
{
    bool g_InvalidValue = false;
    if(str.size()<=0)
    {
        g_InvalidValue = true;
        return 0;
    }
    int i = 0;
    int sum = 0;
    bool isPositive = false;
    if(str[i]=='-')
    {
        isPositive = true;
        i++;
    }
    else if(str[i]=='+')
    {
        i++;
    }
    while(str[i])
    {
        if(str[i]<='9'&&str[i]>='0')
        {
            sum = sum*10+str[i]-'0'+0;
        }
        else
        {
            g_InvalidValue = true;
            return 0;
        }
        i++;
    }
    if(isPositive)
        sum = -sum;
    return sum;
}
2
Ron
public class Solution {
    public  int StrToInt(String str) {  	
    	if(str == "" || str == null)
    		return 0;
    	char[] chars = str.toCharArray();
    	int length = chars.length;
    	boolean negative = false;
    	int limit = -Integer.MAX_VALUE;
    	int i = 0;
    	int digit, multMin;
    	int result = 0;
    	if(length > 0){
    		char firstChar = chars[0];
    		if(firstChar < '0'){ //may be '+' or '-'
    			if(firstChar == '-'){
    				negative = true;
    				limit = Integer.MIN_VALUE;
    			}else if(firstChar != '+'){
    				return 0;
    			}   		
    			if(length == 1) //only '+'
    				return 0;
    			i++;
    		}
    		multMin = limit / 10;
    		while(i < length){
    			digit = Character.digit(chars[i++], 10);
    			if(digit < 0)
    				return 0;
    			if(result < multMin){
    				return 0;
    			}
    			result *= 10;
    			if(result < limit + digit){ //digit必须放在不等式右侧防止左侧溢出，判断防止最终溢出
    				return 0;
    			}		
    			result -= digit;
    		} 	
    	}else{
    		return 0;
    	}
    	return negative? result : -result;
    }
}
